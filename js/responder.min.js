(function(e){var b={submitBlockedInPreview:"You cannot submit a response because this is just a preview of the content.",submitEmailRequired:"You must enter an email address before submitting.",submitEmailInvalid:"The email you entered does not appear to be a valid email address.",submitNoAnswers:"You must select an answer to at least one question before submitting.",submitSuccessCheckEmail:"Your response has been submitted.  Thank you for participating!  Please check your email for instructions on verifying your submission.",submitSuccess:"Your response has been submitted.  Thank you for participating!",submitError:"Apologies!  An error has occurred while attempting to submit your responses.  Please try again in a moment."};var a=[];var d=function(i){i.preventDefault();var m=0;var k=i.target.id.match(/ingagehub_submit_([0-9]+)/);if(k){m=k[1]}else{return}var n="_"+m;var l=n.length;var h={action:"com_ingagehub_cr",id:m};var j=e("#ingagehub_collect_email_"+m).val();var g=e("#ingagehub_token_"+m).val();if(g.length===0||location.href.indexOf("&preview")>0){alert(b.submitBlockedInPreview);return}else{if(j.length==0){alert(b.submitEmailRequired);return}else{if(!j.match(".+\\@.+\\..+")){alert(b.submitEmailInvalid);return}}}var p=0;var o=0;e.each(a,function(s,A){var y=A.id.match(/ingagehub_attachment.*_([0-9]+)_([0-9]+)$/);if(y&&y[2]===m){var r=y[1];var w=e(A)[0].tagName.toLowerCase()==="input"?e(A).attr("type").toLowerCase():"textarea";var u=e("#ingagehub_attachment_response_format_"+r+"_"+m).val();if(u==="0"||u==="1"){if(w==="radio"||w==="checkbox"){h[A.id]={value:A.value,checked:A.checked};var q=e("#ingagehub_attachment_free_text_"+r+"_"+m);var x=e("#ingagehub_attachment_free_text_value_"+r+"_"+m);if(q.length>0&&x.length>0&&x.val()===A.value&&A.checked){h[A.id].freeText=q.val()}p++;if(A.checked){o++}}}else{if(u==="2"){var z=A.id.match(/ingagehub_attachment_([0-9]+)_[0-9]+_[0-9]+$/);if(z&&w==="hidden"){var t=e("#ingagehub_attachment_rank_"+z[1]+"_"+r+"_"+m);h[A.id]={value:A.value,checked:true,rank:t.val()};p++;if(t.val()!==A.value){o++}}}else{if(u==="3"){if(A.id==="ingagehub_attachment_1_"+r+"_"+m){h[A.id]={value:A.value,checked:true,freeText:e("#ingagehub_attachment_free_text_"+r+"_"+m).val()};p++;if(h[A.id].freeText.trim().length>0){o++}}}}}}else{if(A.id.indexOf(n)==A.id.length-l){h[A.id]={value:A.value}}}});if(p>0&&o===0){alert(b.submitNoAnswers)}else{e(i.target).prop("disabled",true);e(i.target).css("opacity",0.5);jQuery.ajax(INgageHub.ajaxUrl,{method:"POST",data:h,dataType:"json",success:function(q){if(q.response.status==="OK"){if(q.response.sending_email===true){alert(b.submitSuccessCheckEmail)}else{alert(b.submitSuccess)}if(q.next_page.length>0){location.href=q.next_page}}else{alert(b.submitError)}e(i.target).prop("disabled",false);e(i.target).css("opacity",1)},error:function(q){alert(b.submitError);e(i.target).prop("disabled",false);e(i.target).css("opacity",1)}})}};var f=function(i){var h=e(i.target);var g=h.parent("li");var j=g.find(".ihOtherBox");if(h.is(":checked")){j.show();j.width(g.width()*0.8)}else{j.hide()}};var c=function(j){var i=e(j.target);var g=i.parent("li").parent("ul");var h=g.find(".ihAnswerInputRank");var l=parseInt(i.val());var k=parseInt(i.attr("data-original-rank"));if(isNaN(l)||!isFinite(l)||l<1||l>h.length){i.val(k);return}if(l!=k){h.each(function(n,m){var p=e(m);var o=parseInt(e(m).val());if(l>k){if(o>=k&&o<=l){p.val(o-1)}}else{if(o>=l&&o<=k){p.val(o+1)}}p.attr("data-original-rank",p.val())})}i.val(l);i.attr("data-original-rank",l)};jQuery(document).ready(function(g){g("*").each(function(i,h){var j=g(h);if(h.id.indexOf("ingagehub_")===0&&(h.tagName.toLowerCase()==="input"||h.tagName.toLowerCase()==="textarea")){a.push(h);if(h.tagName.toLowerCase()==="textarea"){j.width(j.parent("ul").width()*0.8)}}if(h.id.indexOf("ingagehub_submit_")===0&&h.tagName.toLowerCase()==="button"){j.click(function(k){d(k)})}if(j.hasClass("ihOtherBoxTrigger")){j.click(function(k){f(k)})}if(j.hasClass("ihAnswerInputRank")){j.attr("data-original-rank",j.val());j.blur(function(k){c(k)})}})})})(jQuery);